!function(t,e,o){"use strict";var i=e(t),n=e(document),s=e("#wpadminbar"),f=e("#wpfooter");e(function(){function o(){var t=i.width();I={windowHeight:i.height(),windowWidth:t,adminBarHeight:0,toolsHeight:H.outerHeight()||0,menuBarHeight:B.outerHeight()||0,visualTopHeight:b.outerHeight()||0,textTopHeight:x.outerHeight()||0,bottomHeight:T.outerHeight()||0,statusBarHeight:S.outerHeight()||0,sideSortablesHeight:O.height()||0},I.menuBarHeight<3&&(I.menuBarHeight=0)}function s(e){var o,i,n,s,f,a=jQuery.ui.keyCode,d=e.keyCode,c=document.createRange(),u=y[0].selectionStart,r=y[0].selectionEnd,l=C[0].firstChild,p=10;if(!u||!r||u===r){try{c.setStart(l,u),c.setEnd(l,r+1)}catch(g){}o=c.getBoundingClientRect(),o.height&&(i=o.top-p,n=i+o.height+p,s=I.adminBarHeight+I.toolsHeight+I.textTopHeight,f=I.windowHeight-I.bottomHeight,s>i&&(d===a.UP||d===a.LEFT||d===a.BACKSPACE)?t.scrollTo(t.pageXOffset,i+t.pageYOffset-s):n>f&&t.scrollTo(t.pageXOffset,n+t.pageYOffset-f))}}function a(){if(!(g&&!g.isHidden()||!g&&"tinymce"===V)){var t,e=y.height();C.width(y.width()-22),C.text(y.val()+"&nbsp;"),t=C.height(),L>t&&(t=L),t!==e&&(y.height(t),d())}}function d(e){if(!k||!k.settings.visible){var s,d,c,u,r,l,p,h,m,A=i.scrollTop(),_=e&&e.type,R="scroll"!==_,D=g&&!g.isHidden(),V=L,N=E.offset().top,M=1,Q=w.width();(R||!I.windowHeight)&&o(),D||"resize"!==_||a(),D?(s=b,d=v,p=I.visualTopHeight):(s=x,d=y,p=I.textTopHeight),(D||s.length)&&(l=s.parent().offset().top,h=d.offset().top,m=d.outerHeight(),r=D?L+p:L+20,r=m>r+5,r?((!W||R)&&A>=l-I.toolsHeight-I.adminBarHeight&&A<=l-I.toolsHeight-I.adminBarHeight+m-V?(W=!0,H.css({position:"fixed",top:I.adminBarHeight,width:Q}),D&&B.length&&B.css({position:"fixed",top:I.adminBarHeight+I.toolsHeight,width:Q-2*M-(D?0:s.outerWidth()-s.width())}),s.css({position:"fixed",top:I.adminBarHeight+I.toolsHeight+I.menuBarHeight,width:Q-2*M-(D?0:s.outerWidth()-s.width())})):(W||R)&&(A<=l-I.toolsHeight-I.adminBarHeight?(W=!1,H.css({position:"absolute",top:0,width:Q}),D&&B.length&&B.css({position:"absolute",top:0,width:Q-2*M}),s.css({position:"absolute",top:I.menuBarHeight,width:Q-2*M-(D?0:s.outerWidth()-s.width())})):A>=l-I.toolsHeight-I.adminBarHeight+m-V&&(W=!1,H.css({position:"absolute",top:m-V,width:Q}),D&&B.length&&B.css({position:"absolute",top:m-V,width:Q-2*M}),s.css({position:"absolute",top:m-V+I.menuBarHeight,width:Q-2*M-(D?0:s.outerWidth()-s.width())}))),(!Y||R&&j)&&A+I.windowHeight<=h+m+I.bottomHeight+I.statusBarHeight+M?e&&e.deltaHeight>0&&e.deltaHeight<100?t.scrollBy(0,e.deltaHeight):j&&(Y=!0,S.css({position:"fixed",bottom:I.bottomHeight,visibility:"",width:Q-2*M}),T.css({position:"fixed",bottom:0,width:Q})):(!j&&Y||(Y||R)&&A+I.windowHeight>h+m+I.bottomHeight+I.statusBarHeight-M)&&(Y=!1,S.attr("style",j?"":"visibility: hidden;"),T.attr("style",""))):R&&(H.css({position:"absolute",top:0,width:Q}),D&&B.length&&B.css({position:"absolute",top:0,width:Q-2*M}),s.css({position:"absolute",top:I.menuBarHeight,width:Q-2*M-(D?0:s.outerWidth()-s.width())}),S.attr("style",j?"":"visibility: hidden;"),T.attr("style","")),z.width()<300&&I.windowWidth>600&&n.height()>O.height()+N+120&&I.windowHeight<m?(I.sideSortablesHeight+X+F>I.windowHeight||K||U?N>=A+X?(O.attr("style",""),K=U=!1):A>P?K?(K=!1,c=O.offset().top-I.adminBarHeight,u=f.offset().top,u<c+I.sideSortablesHeight+F&&(c=u-I.sideSortablesHeight-12),O.css({position:"absolute",top:c,bottom:""})):!U&&I.sideSortablesHeight+O.offset().top+F<A+I.windowHeight&&(U=!0,O.css({position:"fixed",top:"auto",bottom:F})):P>A&&(U?(U=!1,c=O.offset().top-F,u=f.offset().top,u<c+I.sideSortablesHeight+F&&(c=u-I.sideSortablesHeight-12),O.css({position:"absolute",top:c,bottom:""})):!K&&O.offset().top>=A+X&&(K=!0,O.css({position:"fixed",top:X,bottom:""}))):(A>=N-X?O.css({position:"fixed",top:X}):O.attr("style",""),K=U=!1),P=A):(O.attr("style",""),K=U=!1),R&&(w.css({paddingTop:I.toolsHeight}),D?v.css({paddingTop:I.visualTopHeight+I.menuBarHeight}):(y.css({marginTop:I.textTopHeight}),C.width(Q-20-2*M))))}}function c(){a(),d()}function u(t){for(var e=1;6>e;e++)setTimeout(t,500*e)}function r(){clearTimeout(h),h=setTimeout(d,100)}function l(){t.pageYOffset&&t.pageYOffset>D&&t.scrollTo(t.pageXOffset,0),m.addClass("wp-editor-expand"),i.on("scroll.editor-expand resize.editor-expand",function(t){d(t.type),r()}),n.on("wp-collapse-menu.editor-expand postboxes-columnchange.editor-expand editor-classchange.editor-expand",d).on("postbox-toggled.editor-expand",function(){!K&&!U&&t.pageYOffset>X&&(U=!0,t.scrollBy(0,-1),d(),t.scrollBy(0,1)),d()}).on("wp-window-resized.editor-expand",function(){g&&!g.isHidden()?g.execCommand("wpAutoResize"):a()}),y.on("focus.editor-expand input.editor-expand propertychange.editor-expand",a),y.on("keyup.editor-expand",s),A(),k&&k.pubsub.subscribe("hidden",c),g&&(g.settings.wp_autoresize_on=!0,g.execCommand("wpAutoResizeOn"),g.isHidden()||g.execCommand("wpAutoResize")),(!g||g.isHidden())&&a(),d(),n.trigger("editor-expand-on")}function p(){var o=parseInt(t.getUserSetting("ed_size",300),10);50>o?o=50:o>5e3&&(o=5e3),t.pageYOffset&&t.pageYOffset>D&&t.scrollTo(t.pageXOffset,0),m.removeClass("wp-editor-expand"),i.off(".editor-expand"),n.off(".editor-expand"),y.off(".editor-expand"),R(),k&&k.pubsub.unsubscribe("hidden",c),e.each([b,x,H,B,T,S,w,v,y,O],function(t,e){e&&e.attr("style","")}),W=Y=K=U=!1,g&&(g.settings.wp_autoresize_on=!1,g.execCommand("wpAutoResizeOff"),g.isHidden()||(y.hide(),o&&g.theme.resizeTo(null,o))),o&&y.height(o),n.trigger("editor-expand-off")}var g,h,m=e("#postdivrich"),w=e("#wp-content-wrap"),H=e("#wp-content-editor-tools"),b=e(),v=e(),x=e("#ed_toolbar"),y=e("#content"),C=e('<div id="content-textarea-clone" class="wp-exclude-emoji"></div>'),T=e("#post-status-info"),B=e(),S=e(),O=e("#side-sortables"),z=e("#postbox-container-1"),E=e("#post-body"),k=t.wp.editor&&t.wp.editor.fullscreen,A=function(){},R=function(){},W=!1,Y=!1,K=!1,U=!1,P=0,D=130,X=56,F=20,L=300,V=w.hasClass("tmce-active")?"tinymce":"html",j=!!parseInt(t.getUserSetting("hidetb"),10),I={windowHeight:0,windowWidth:0,adminBarHeight:0,toolsHeight:0,menuBarHeight:0,visualTopHeight:0,textTopHeight:0,bottomHeight:0,statusBarHeight:0,sideSortablesHeight:0};C.insertAfter(y),C.css({"font-family":y.css("font-family"),"font-size":y.css("font-size"),"line-height":y.css("line-height"),"white-space":"pre-wrap","word-wrap":"break-word"}),n.on("tinymce-editor-init.editor-expand",function(o,n){function s(){var t,e,o,i=n.selection.getNode();if(n.wp&&n.wp.getView&&(e=n.wp.getView(i)))o=e.getBoundingClientRect();else{t=n.selection.getRng();try{o=t.getClientRects()[0]}catch(s){}o||(o=i.getBoundingClientRect())}return o.height?o:!1}function f(t){var e=t.keyCode;47>=e&&e!==H.SPACEBAR&&e!==H.ENTER&&e!==H.DELETE&&e!==H.BACKSPACE&&e!==H.UP&&e!==H.LEFT&&e!==H.DOWN&&e!==H.UP||e>=91&&93>=e||e>=112&&123>=e||144===e||145===e||c(e)}function c(e){var o,i,f,a,d=s(),c=50;d&&(o=d.top+n.iframeElement.getBoundingClientRect().top,i=o+d.height,o-=c,i+=c,f=I.adminBarHeight+I.toolsHeight+I.menuBarHeight+I.visualTopHeight,a=I.windowHeight-(j?I.bottomHeight+I.statusBarHeight:0),a-f<d.height||(f>o&&(e===H.UP||e===H.LEFT||e===H.BACKSPACE)?t.scrollTo(t.pageXOffset,o+t.pageYOffset-f):i>a&&t.scrollTo(t.pageXOffset,i+t.pageYOffset-a)))}function r(t){t.state||d()}function l(){i.on("scroll.mce-float-panels",x),setTimeout(function(){n.execCommand("wpAutoResize"),d()},300)}function p(){i.off("scroll.mce-float-panels"),setTimeout(function(){var e=w.offset().top;t.pageYOffset>e&&t.scrollTo(t.pageXOffset,e-I.adminBarHeight),a(),d()},100),d()}function h(){j=!j}var H=t.tinymce.util.VK,x=_.debounce(function(){!e(".mce-floatpanel:hover").length&&t.tinymce.ui.FloatPanel.hideAll(),e(".mce-tooltip").hide()},1e3,!0);"content"===n.id&&(g=n,n.settings.autoresize_min_height=L,b=w.find(".mce-toolbar-grp"),v=w.find(".mce-edit-area"),S=w.find(".mce-statusbar"),B=w.find(".mce-menubar"),A=function(){n.on("keyup",f),n.on("show",l),n.on("hide",p),n.on("wp-toolbar-toggle",h),n.on("setcontent wp-autoresize wp-toolbar-toggle",d),n.on("undo redo",c),n.on("FullscreenStateChanged",r),i.off("scroll.mce-float-panels").on("scroll.mce-float-panels",x)},R=function(){n.off("keyup",f),n.off("show",l),n.off("hide",p),n.off("wp-toolbar-toggle",h),n.off("setcontent wp-autoresize wp-toolbar-toggle",d),n.off("undo redo",c),n.off("FullscreenStateChanged",r),i.off("scroll.mce-float-panels")},m.hasClass("wp-editor-expand")&&(A(),u(d)))}),m.hasClass("wp-editor-expand")&&(l(),w.hasClass("html-active")&&u(function(){d(),a()})),e("#adv-settings .editor-expand").show(),e("#editor-expand-toggle").on("change.editor-expand",function(){e(this).prop("checked")?(l(),t.setUserSetting("editor_expand","on")):(p(),t.setUserSetting("editor_expand","off"))}),t.editorExpand={on:l,off:p}}),e(function(){function o(){B=Y.offset(),B.right=B.left+Y.outerWidth(),B.bottom=B.top+Y.outerHeight()}function a(){j||(j=!0,n.trigger("dfw-activate"),U.on("keydown.focus-shortcut",x))}function d(){j&&(r(),j=!1,n.trigger("dfw-deactivate"),U.off("keydown.focus-shortcut"))}function c(){return j}function u(){!I&&j&&(I=!0,U.on("keydown.focus",g),K.add(U).on("blur.focus",m),g(),t.setUserSetting("post_dfw","on"),n.trigger("dfw-on"))}function r(){I&&(I=!1,K.add(U).off(".focus"),h(),Y.off(".focus"),t.setUserSetting("post_dfw","off"),n.trigger("dfw-off"))}function l(){I?r():u()}function p(){return I}function g(e){var n=e&&e.keyCode;return 27===n||87===n&&e.altKey&&e.shiftKey?void h(e):void(e&&(e.metaKey||e.ctrlKey&&!e.altKey||e.altKey&&e.shiftKey||n&&(47>=n&&8!==n&&13!==n&&32!==n&&46!==n||n>=91&&93>=n||n>=112&&135>=n||n>=144&&150>=n||n>=224))||(y||(y=!0,clearTimeout(A),A=setTimeout(function(){P.show()},600),Y.css("z-index",9998),P.on("mouseenter.focus",function(){o(),i.on("scroll.focus",function(){var e=t.pageYOffset;E&&z&&E!==e&&(z<B.top-Q||z>B.bottom+Q)&&h(),E=e})}).on("mouseleave.focus",function(){S=O=null,N=M=0,i.off("scroll.focus")}).on("mousemove.focus",function(e){var o=e.clientX,i=e.clientY,n=t.pageYOffset,s=t.pageXOffset;if(S&&O&&(o!==S||i!==O))if(O>=i&&i<B.top-n||i>=O&&i>B.bottom-n||S>=o&&o<B.left-s||o>=S&&o>B.right-s){if(N+=Math.abs(S-o),M+=Math.abs(O-i),(i<=B.top-Q-n||i>=B.bottom+Q-n||o<=B.left-Q-s||o>=B.right+Q-s)&&(N>10||M>10))return h(),S=O=null,void(N=M=0)}else N=M=0;S=o,O=i}).on("touchstart.focus",function(t){t.preventDefault(),h()}),Y.off("mouseenter.focus"),k&&(clearTimeout(k),k=null),R.addClass("focus-on").removeClass("focus-off")),w(),b()))}function h(t){y&&(y=!1,clearTimeout(A),A=setTimeout(function(){P.hide()},200),Y.css("z-index",""),P.off("mouseenter.focus mouseleave.focus mousemove.focus touchstart.focus"),"undefined"==typeof t&&Y.on("mouseenter.focus",function(){(e.contains(Y.get(0),document.activeElement)||_)&&g()}),k=setTimeout(function(){k=null,Y.off("mouseenter.focus")},1e3),R.addClass("focus-off").removeClass("focus-on")),H(),v()}function m(){setTimeout(function(){function t(t){return e.contains(t.get(0),document.activeElement)}var o=document.activeElement.compareDocumentPosition(Y.get(0));2!==o&&4!==o||!(t(F)||t(W)||t(f))||h()},0)}function w(){!C&&y&&(C=!0,s.on("mouseenter.focus",function(){s.addClass("focus-off")}).on("mouseleave.focus",function(){s.removeClass("focus-off")}))}function H(){C&&(C=!1,s.off(".focus"))}function b(){T||!y||D.find(":focus").length||(T=!0,D.stop().fadeTo("fast",.3).on("mouseenter.focus",v).off("mouseleave.focus"),X.on("focus.focus",v).off("blur.focus"))}function v(){T&&(T=!1,D.stop().fadeTo("fast",1).on("mouseleave.focus",b).off("mouseenter.focus"),X.on("blur.focus",b).off("focus.focus"))}function x(t){t.altKey&&t.shiftKey&&87===t.keyCode&&l()}var y,C,T,B,S,O,z,E,k,A,_,R=e(document.body),W=e("#wpcontent"),Y=e("#post-body-content"),K=e("#title"),U=e("#content"),P=e(document.createElement("DIV")),D=e("#edit-slug-box"),X=D.find("a").add(D.find("button")).add(D.find("input")),F=e("#adminmenuwrap"),L=e(),V=e(),j="on"===t.getUserSetting("editor_expand","on"),I=j?"on"===t.getUserSetting("post_dfw"):!1,N=0,M=0,Q=20;R.append(P),P.css({display:"none",position:"fixed",top:s.height(),right:0,bottom:0,left:0,"z-index":9997}),Y.css({position:"relative"}),i.on("mousemove.focus",function(t){z=t.pageY}),e("#postdivrich").hasClass("wp-editor-expand")&&U.on("keydown.focus-shortcut",x),n.on("tinymce-editor-setup.focus",function(t,e){e.addButton("dfw",{active:I,classes:"wp-dfw btn widget",disabled:!j,onclick:l,onPostRender:function(){var t=this;n.on("dfw-activate.focus",function(){t.disabled(!1)}).on("dfw-deactivate.focus",function(){t.disabled(!0)}).on("dfw-on.focus",function(){t.active(!0)}).on("dfw-off.focus",function(){t.active(!1)})},tooltip:"Distraction-free writing mode",shortcut:"Alt+Shift+W"}),e.addCommand("wpToggleDFW",l),e.addShortcut("alt+shift+w","","wpToggleDFW")}),n.on("tinymce-editor-init.focus",function(t,i){function s(){_=!0}function f(){_=!1}var a,d;"content"===i.id&&(L=e(i.getWin()),V=e(i.getContentAreaContainer()).find("iframe"),a=function(){i.on("keydown",g),i.on("blur",m),i.on("focus",s),i.on("blur",f),i.on("wp-autoresize",o)},d=function(){i.off("keydown",g),i.off("blur",m),i.off("focus",s),i.off("blur",f),i.off("wp-autoresize",o)},I&&a(),n.on("dfw-on.focus",a).on("dfw-off.focus",d),i.on("click",function(t){t.target===i.getDoc().documentElement&&i.focus()}))}),n.on("quicktags-init",function(t,o){var i;o.settings.buttons&&-1!==(","+o.settings.buttons+",").indexOf(",dfw,")&&(i=e("#"+o.name+"_dfw"),e(document).on("dfw-activate",function(){i.prop("disabled",!1)}).on("dfw-deactivate",function(){i.prop("disabled",!0)}).on("dfw-on",function(){i.addClass("active")}).on("dfw-off",function(){i.removeClass("active")}))}),n.on("editor-expand-on.focus",a).on("editor-expand-off.focus",d),I&&(U.on("keydown.focus",g),K.add(U).on("blur.focus",m)),t.wp=t.wp||{},t.wp.editor=t.wp.editor||{},t.wp.editor.dfw={activate:a,deactivate:d,isActive:c,on:u,off:r,toggle:l,isOn:p}})}(window,window.jQuery);